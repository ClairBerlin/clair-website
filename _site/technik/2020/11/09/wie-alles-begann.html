<!doctype html>
<html lang="de">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Oxygen:wght@400;700&family=Roboto:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Clair Berlin">
    <link rel="shortcut icon" type="image/svg+xml" href="/img/clair-cloud-blue.svg">

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Wie alles begann | Clair Berlin</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Wie alles begann" />
<meta name="author" content="Jan Weil" />
<meta property="og:locale" content="de_DE" />
<meta name="description" content="Als Uli mich Anfang September überzeugt hatte, das Projekt mit den vernetzten CO2-Sensoren anzugehen, war das Berliner The Things Network eine naheliegende Lösung zur Anbindung der Sensoren. Ich hatte mich schon länger mal mit LoRaWAN auseinandersetzen wollen, da uns diese Funktechnologie und ähnliche wie z. B. NB-IoT in früheren Projekten mehrfach vorgeschlagen wurden." />
<meta property="og:description" content="Als Uli mich Anfang September überzeugt hatte, das Projekt mit den vernetzten CO2-Sensoren anzugehen, war das Berliner The Things Network eine naheliegende Lösung zur Anbindung der Sensoren. Ich hatte mich schon länger mal mit LoRaWAN auseinandersetzen wollen, da uns diese Funktechnologie und ähnliche wie z. B. NB-IoT in früheren Projekten mehrfach vorgeschlagen wurden." />
<link rel="canonical" href="https://clair-berlin.de/technik/2020/11/09/wie-alles-begann.html" />
<meta property="og:url" content="https://clair-berlin.de/technik/2020/11/09/wie-alles-begann.html" />
<meta property="og:site_name" content="Clair Berlin" />
<meta property="og:image" content="https://clair-berlin.de/img/clairchen.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-09T08:02:29+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://clair-berlin.de/img/clairchen.jpg" />
<meta property="twitter:title" content="Wie alles begann" />
<meta name="twitter:site" content="@clair_berlin" />
<meta name="twitter:creator" content="@Jan Weil" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Wie alles begann","dateModified":"2020-11-09T08:02:29+01:00","url":"https://clair-berlin.de/technik/2020/11/09/wie-alles-begann.html","datePublished":"2020-11-09T08:02:29+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://clair-berlin.de/technik/2020/11/09/wie-alles-begann.html"},"author":{"@type":"Person","name":"Jan Weil"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://clair-berlin.de/img/clair-cloud-blue.svg"},"name":"Jan Weil"},"description":"Als Uli mich Anfang September überzeugt hatte, das Projekt mit den vernetzten CO2-Sensoren anzugehen, war das Berliner The Things Network eine naheliegende Lösung zur Anbindung der Sensoren. Ich hatte mich schon länger mal mit LoRaWAN auseinandersetzen wollen, da uns diese Funktechnologie und ähnliche wie z. B. NB-IoT in früheren Projekten mehrfach vorgeschlagen wurden.","image":"https://clair-berlin.de/img/clairchen.jpg","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body class="d-flex flex-column h-100">
    <div class="flex-shrink-0" style="margin-top: 74px;">
      <nav class="navbar fixed-top d-flex align-items-center navbar-expand-lg navbar-dark bg-primary justify-content-between">
  <div class="container">
    <a class="d-flex align-items-center navbar-brand logo" href="/">
      <img class="mr-3" src="/img/clair-cloud-white.svg"/>
      Clair Berlin
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="mitmachen" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Mitmachen
          </a>
          <div class="dropdown-menu" aria-labelledby="mitmachen">
            
            <a class="dropdown-item" href="/mitmachen.html">Registrieren</a>
            
            <a class="dropdown-item" href="/installation.html">Sensor installieren</a>
            
            <a class="dropdown-item" href="/selbstbau-sensor.html">Sensor selbst bauen</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="über-clair-berlin" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Über Clair Berlin
          </a>
          <div class="dropdown-menu" aria-labelledby="über-clair-berlin">
            
            <a class="dropdown-item" href="/hintergrund.html">Wissenschaft</a>
            
            <a class="dropdown-item" href="/technik.html">Technik</a>
            
            <a class="dropdown-item" href="/team.html">Team</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="/neuigkeiten.html">Neuigkeiten</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="/faq.html">FAQ</a>
        </li>
        
        
      </ul>
      <a class="btn btn-outline-light mt-3 mt-lg-0 ml-0 ml-lg-3" href="/dashboard/">Mein Konto</a>
    </div>
  </div>
</nav>

      <a href="/faq.html#was-bedeutet-testbetrieb">
  <div style="z-index: 100;" class="alert alert-warning alert-dismissible fade show mb-0 text-center" role="alert">
    <strong>Clair Berlin befindet sich zur Zeit im Testbetrieb.</strong>
  </div>
</a>

      <main role="main" class="container py-5">
  <div class="container">
  <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
      <h1 class="post-title p-name" itemprop="name headline">Wie alles begann</h1>
      <p class="post-meta"><time class="dt-published" datetime="2020-11-09T08:02:29+01:00" itemprop="datePublished">
        09.11.2020
      </time>• 
      <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-author h-card" itemprop="name">Jan Weil</span></span></p>
    </header>

    <div class="post-content e-content" itemprop="articleBody">
      <p>Als Uli mich Anfang September überzeugt hatte, das Projekt mit den vernetzten CO<sub>2</sub>-Sensoren anzugehen, war das Berliner <a href="https://thethingsnetwork.org">The Things Network</a> eine naheliegende Lösung zur Anbindung der Sensoren. Ich hatte mich schon länger mal mit <a href="https://de.wikipedia.org/wiki/Long_Range_Wide_Area_Network">LoRaWAN</a> auseinandersetzen wollen, da uns diese Funktechnologie und ähnliche wie z. B.  <a href="https://en.wikipedia.org/wiki/Narrowband_IoT">NB-IoT</a> in früheren Projekten mehrfach vorgeschlagen wurden.</p>

<p>Um alle Eigenarten des Systems zu verstehen, fingen wir ganz unten an und bauten einen eigenen Prototyp auf. Nach etwas Recherche entschieden wir uns für eine Kombination aus dem Radiofrüchtchen <a href="https://www.adafruit.com/product/3178">Feather M0 RFM95 LoRa Radio (900MHz)</a> von <a href="https://www.adafruit.com">Adafruit</a> und dem CO<sub>2</sub>-Sensor <a href="https://www.sensirion.com/scd30/">SCD30</a> von <a href="https://www.sensirion.com">Sensirion</a>.</p>

<h2 id="breadboard-aufbau">Breadboard-Aufbau</h2>

<p>Wir folgten dem <a href="https://learn.adafruit.com/the-things-network-for-feather">Adafruit TTN-Tutorial</a>, legten unsere erste TTN-Applikation an und waren dank des Gateways auf dem Schöneberger EUREF-Campus tatsächlich innerhalb kürzester Zeit online.</p>

<p>Danach schlossen wir auf unserem simplen Breadboard-Layout den SCD30 per <a href="https://de.wikipedia.org/wiki/I%C2%B2C">I<sup>2</sup>C</a> an. Das Ergebnis sah und sieht bis heute so aus:</p>

<p><img src="/img/clairchen.jpg" alt="Clairchen" /></p>

<p>Zu besseren Übersicht in Draufsicht:</p>

<p><img src="/img/clairchen-draufsicht.jpg" alt="Clairchen Draufsicht" /></p>

<p>Wir nutzten die <a href="https://github.com/sparkfun/SparkFun_SCD30_Arduino_Library">SCD30-Arduino-Library</a> von <a href="https://www.sparkfun.com/">Sparkfun</a>, um den SCD30 anzusprechen und konnten mit Freude nachvollziehen, wie die CO<sub>2</sub>-Messwerte in die Höhe schossen, wenn man den SCD30 anhauchte.</p>

<h2 id="software">Software</h2>

<p>Bis hierher hatten wir im Wesentlichen <a href="https://www.arduino.cc/">Arduino</a>-Beispiel-Sketches der verschiedenen Librarys zusammenkopiert. Nun ging es darum, unserem Aufbau etwas mehr Intelligenz zu gönnen.</p>

<p>Die größte Herausforderung war es dabei, die Anforderungen unserer Anwendung mit der <a href="https://www.thethingsnetwork.org/docs/lorawan/duty-cycle.html">Fair Access Policy</a> des TTN in Einklang zu bringen. Unser Ziel war und ist es, Messdaten (zumindest zu relevanten Tageszeiten) mit ausreichend hoher Auflösung und möglichest geringer Latenz zur Verfügung zu stellen. Um z. B. die Entwicklung der CO<sub>2</sub>-Konzentration in einem Klassenraum während einer Schulstunde nachvollziehen zu können, reicht es nicht, drei Messwerte pro Stunde zu übertragen, und wenn im richtigen Moment darauf aufmerksam gemacht werden soll, dass das Fenster geöffnet werden sollte, sollten die Daten nicht mit einer halben Stunde Verzögerung eintrudeln.</p>

<p>Die Fair Access Policy des TTN schreibt vor, dass jedes Gerät <em>max. 30 s Airtime pro 24 Stunden</em> im Uplink belegen sollte. Die Herausforderung besteht nun darin, dass ein Gerät, das relativ weit von einem Gateway entfernt ist, einen hohen <a href="https://www.thethingsnetwork.org/docs/lorawan/modulation-data-rate.html">Spreading Factor</a> verwenden muss, damit seine Nachrichten vom Gateway empfangen werden.  Solcherart kodierte Nachrichten können aber leider über eine Sekunde lang werden, so dass das tägliche Airtime-Kontingent schnell verbraucht ist.  Deshalb haben wir für unseren Prototyp die Mess- und die Übertragungsfrequenz vom jeweils aktuellen <em>Modulation and Coding Scheme</em> abhängig gemacht. Die Details unseres so entworfenen Übertragungsschemas sind in <a href="https://github.com/ClairBerlin/clair-doc/blob/master/node-protocol/sampling-and-transmission-scheme.pdf">einem Design-Dokument</a> beschrieben.</p>

<p>Leider lassen sich für viele kommerziell verfügbaren Sensoren die Übertragungschemata nicht in ähnlicher Weise anpassen, was sie, sofern nicht ausreichend Gateways zur Verfügung stehen, für das TTN in unseren Augen schnell unattraktiv macht.</p>

<p>Der Quellcode für unseren ersten Prototyp ist <a href="https://github.com/ClairBerlin/clairchen">auf GitHub</a> verfügbar und die Aufbauanleitung für Bastler haben wir <a href="/selbstbau-sensor.html">hier</a> nochmal etwas strukturierter zusammengefasst.</p>

    </div><a class="u-url" href="/technik/2020/11/09/wie-alles-begann.html" hidden></a>


<div class="mt-4">
  Diesen Beitrag teilen:

  <span class="h5">
    <a class=" share-btn-twitter"
       rel="noopener"
       href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fclair-berlin.de%2Ftechnik%2F2020%2F11%2F09%2Fwie-alles-begann.html&text=Wie+alles+begann">
      <i class="fab fa-twitter"></i>
      
    </a>
    <a class=" share-btn-facebook"
       rel="noopener"
       href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fclair-berlin.de%2Ftechnik%2F2020%2F11%2F09%2Fwie-alles-begann.html&title=Wie+alles+begann">
      <i class="fab fa-facebook-square"></i>
      

    </a>
    <a class=" share-btn-linkedin"
       rel="noopener"
       href="http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fclair-berlin.de%2Ftechnik%2F2020%2F11%2F09%2Fwie-alles-begann.html&title=Wie+alles+begann">
      <i class="fab fa-linkedin"></i>
      
    </a>
  </span>
</div>
</article>
</div>

</main>

    </div>

    <footer class="py-4 mt-auto text-light text-center bg-dark">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 col-sm-4 my-2">
        <nav class="nav flex-column">
          
            <a class="nav-link" href="/impressum.html">Impressum</a>
          
            <a class="nav-link" href="/datenschutz.html">Datenschutz</a>
          
        </nav>
      </div>
      <div class="col-12 col-sm-4 my-2">
        &copy; 2020 Clair Berlin
      </div>
      <div class="col-12 col-sm-4 my-2">
        
          <a class="mx-2" href="mailto:kontakt@clair-berlin.de"><i class="h2 fas fa-envelope"></i></a>
        
          <a class="mx-2" href="https://twitter.com/clair_berlin"><i class="h2 fab fa-twitter"></i></a>
        
          <a class="mx-2" href="https://www.facebook.com/ClairBerlinInitiative"><i class="h2 fab fa-facebook-square"></i></a>
        
          <a class="mx-2" href="/feed.xml"><i class="h2 fas fa-rss-square"></i></a>
        
          <a class="mx-2" href="https://github.com/ClairBerlin"><i class="h2 fab fa-github"></i></a>
        
      </div>
    </div>
  </div>
</footer>

    <script src="/js/jquery-3.5.1.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script>
      function openAnchorAccordion() {
        if (window.location.hash) {
          const hash = window.location.hash
          var target = jQuery('body').find(window.location.hash);
          if (target.hasClass('faq')) {
            var collapsable = target.find('.collapse');
            collapsable.collapse('show');
            collapsable.on('shown.bs.collapse', function (e) {
              location.hash = hash
            })
          }
        }
      }

      openAnchorAccordion();

      $("a[href*='#']").click(function(e) {
        window.location = e.currentTarget.href
        openAnchorAccordion();
      });
    </script>
  </body>
</html>
