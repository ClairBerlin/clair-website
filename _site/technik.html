<!doctype html>
<html lang="de">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Oxygen:wght@400;700&family=Roboto:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Clair Berlin">
    <link rel="shortcut icon" type="image/svg+xml" href="/img/clair-cloud-blue.svg">

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Technik | Clair Berlin</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Technik" />
<meta property="og:locale" content="de_DE" />
<meta name="description" content="Clair Berlin - nichtkommerzielle Initiative zur Messung der Luftqualität in öffentlich zugänglichen Räumen" />
<meta property="og:description" content="Clair Berlin - nichtkommerzielle Initiative zur Messung der Luftqualität in öffentlich zugänglichen Räumen" />
<link rel="canonical" href="https://clair-berlin.de/technik.html" />
<meta property="og:url" content="https://clair-berlin.de/technik.html" />
<meta property="og:site_name" content="Clair Berlin" />
<meta property="og:image" content="https://clair-berlin.de/img/clair-network.png" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://clair-berlin.de/img/clair-network.png" />
<meta property="twitter:title" content="Technik" />
<meta name="twitter:site" content="@clair_berlin" />
<script type="application/ld+json">
{"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://clair-berlin.de/img/clair-cloud-blue.svg"}},"image":"https://clair-berlin.de/img/clair-network.png","headline":"Technik","url":"https://clair-berlin.de/technik.html","description":"Clair Berlin - nichtkommerzielle Initiative zur Messung der Luftqualität in öffentlich zugänglichen Räumen","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body class="d-flex flex-column h-100">
    <div class="flex-shrink-0" style="margin-top: 74px;">
      <nav class="navbar fixed-top d-flex align-items-center navbar-expand-lg navbar-dark bg-primary justify-content-between">
  <div class="container">
    <a class="d-flex align-items-center navbar-brand logo" href="/">
      <img class="mr-3" src="/img/clair-cloud-white.svg"/>
      Clair Berlin
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="mitmachen" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Mitmachen
          </a>
          <div class="dropdown-menu" aria-labelledby="mitmachen">
            
            <a class="dropdown-item" href="/mitmachen.html">Registrieren</a>
            
            <a class="dropdown-item" href="/installation.html">Sensor installieren</a>
            
            <a class="dropdown-item" href="/selbstbau-sensor.html">Sensor selbst bauen</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="über-clair-berlin" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Über Clair Berlin
          </a>
          <div class="dropdown-menu" aria-labelledby="über-clair-berlin">
            
            <a class="dropdown-item" href="/hintergrund.html">Wissenschaft</a>
            
            <a class="dropdown-item" href="/technik.html">Technik</a>
            
            <a class="dropdown-item" href="/team.html">Team</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="/neuigkeiten.html">Neuigkeiten</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="/faq.html">FAQ</a>
        </li>
        
        
      </ul>
      <a class="btn btn-outline-light mt-3 mt-lg-0 ml-0 ml-lg-3" href="/dashboard/">Mein Konto</a>
    </div>
  </div>
</nav>

      <a href="/faq.html#was-bedeutet-testbetrieb">
  <div style="z-index: 100;" class="alert alert-warning alert-dismissible fade show mb-0 text-center" role="alert">
    <strong>Clair Berlin befindet sich zur Zeit im Testbetrieb.</strong>
  </div>
</a>

      <main role="main" class="container py-5">
  <h1 id="technik">Technik</h1>

<p>Clair Berlin entwickelt eine offene Plattform für vernetzte Sensoren mit Schwerpunkt auf CO<sub>2</sub>-Messwerten. Die Clair-Plattform ist <a href="https://www.gnu.org/philosophy/free-sw.de.html">Freie Software</a>. Derzeit nutzen wir zur Anbindung der Sensoren die für Messdaten optimierte LoRaWAN Funktechnologie. Aber die Clair-Plattform legen wir so aus, dass über offene Schnittstellen beliebige Sensortypen und Sensor-Netzwerke angebunden werden können.</p>

<h2 id="sytemüberblick">Sytemüberblick</h2>

<p>Das Clair-Netzwerk besteht aus den in öffentlich zugänglichen Räumen installierten Sensoren, einem Kommunikationsnetzwerk, der Clair-Plattform, sowie verschiedenen Client-Anwendungen. Die folgende Abbildung gibt einen Systemüberblick.</p>

<p><img src="/img/clair-network.png" alt="Systemschaubild Clair-Netzwerk" /></p>

<h3 id="sensoren-und-sensor-netzwerk">Sensoren und Sensor-Netzwerk</h3>

<p>CO<sub>2</sub>-Sensoren messen die CO<sub>2</sub>-Konzentration in mehr oder weniger regelmäßigen Abständen. Zusammen mit ggf. weiteren Messgrößen wie Temperatur oder Luftfeuchtigkeit entsteht ein <em>Sample</em>. Jeder Sensor schickt seine gemessenen Samples regelmäßig an die Clair Plattform. Die Kommunikation erfolgt typischerweise drahtlos bis zu einem Gateway und von dort weiter über das Internet.</p>

<p>Kommerziell erhältliche Sensoren nutzen verschiedene Funknetzwerke: Die auf Messwerte spezialisierten Technologien <a href="https://lora-alliance.org/about-lorawan">LoRaWAN</a> und <a href="https://www.sigfox.com/en">SigFox</a>, das vom Mobilfunk abgeleitete <a href="https://en.wikipedia.org/wiki/Narrowband_IoT">NB-IoT</a>, aber auch bekannte Consumer-Funknetzwerke wie <a href="https://www.wi-fi.org">WiFi</a> oder <a href="https://www.bluetooth.com">Bluetooth</a>. Die auf Messwert- und Internet-of-Things- (IoT) Kommunikation spezialisierten Technologien bieten größere Reichweiten und geringeren Energieverbrauch. Nutzer müssen hier zumeist keine eigenen Gateways aufstellen, und die Sensoren können über Jahre hinweg mit einem Satz Batterien betrieben werden. Allerdings ist die zulässige Datenrate sehr niedrig, so dass nur wenige Samples pro Stunde aufgenommen und übertragen werden dürfen.</p>

<p>In der ersten Ausbaustufe des Clair-Netzwerks setzen wir auf LoRaWAN, da diese Funktechnologie die Grundlage ist des freien, durch eine offene Community betriebenen <a href="https://www.thethingsnetwork.org/community/berlin/">The Things Network</a>. Bei Bedarf und Interesse binden wir aber gerne weitere Sensornetzwerke und Sensortypen ein.</p>

<p>Wer selbst basteln möchte, findet <a href="/selbstbau-sensor.html">hier</a> eine Selbstbauanleitung für unseren Clairchen-Prototyp.</p>

<h3 id="clair-plattform">Clair Plattform</h3>

<p>Für Sensoren, die ins Clair-Netzwerk eingebunden werden sollen, konfigurieren wir eine Verbindung zu einem bestimmten Endpunkt im Things Network. Dieser leitet die Messdaten zu einer passenden <em>TTN Anwendung</em> weiter, die erste Anwendung in der Verarbeitungskette der Clair Plattform.</p>

<p>Eine Übersicht der Clair-Plattform zeigt die folgende Abbildung.
<img src="/img/clair-stack.png" alt="Die Clair Plattform" /></p>

<p>Technisch gesehen besteht die Plattform aus mehreren Anwendungen, welche wir als <a href="https://docs.docker.com/get-started/">Docker</a> Container verpacken und über <a href="https://docs.docker.com/engine/swarm/">Docker Swarm</a> orchestrieren.</p>

<p>Die <em>Forwarder</em> empfangen Messdaten eines bestimmten Sensortyps aus dem Things Network, entschlüsseln und decodieren diese und leiten sie weiter an die <code class="language-plaintext highlighter-rouge">ingestair</code> genannte Anwendung, welche die Daten aufnimmt und in der zentralen Datenbank speichert.</p>

<p>Wenn neue Sensormodelle oder ein neues Funknetzwerk angebunden werden sollen, welche Daten über <a href="https://de.wikipedia.org/wiki/Internet_Protocol">IP</a>-kompatible Protokolle bereitstellen,
müssen wir lediglich einen passenden neuen Forwarder schreiben; der Rest der Plattform ändert sich nicht.</p>

<p>Kern des Systems ist der <em>Clair Server</em>, intern <code class="language-plaintext highlighter-rouge">managair</code> genannt, der
eine
<a href="https://de.wikipedia.org/wiki/Representational_State_Transfer">REST</a>-Schnittstelle
bereitstellt. Diese REST-Schnittstelle steht allen Client-Anwendungen offen, um Messdaten zu beziehen und Sensoren zu verwalten.</p>

<h3 id="datenmodell-des-clair-servers">Datenmodell des Clair-Servers</h3>

<p>Die Clair Plattform bildet real existierende Entitäten ab:</p>

<ul>
  <li><em>User</em> sind natürliche Personen. Sie können sich ein Konto anlegen und sich mittels Benutzername und Passwort über eine Client-Anwendung an der Plattform anmelden.</li>
  <li><em>Organisationen</em> sind die Betreiber von Räumen im juristischen Sinn, also z.B. Firmen oder Vereine. Jede Organisation hat einen oder mehrere <em>User</em> als <em>Mitglieder</em>. Ein User kann gleichzeitig Mitglied mehrerer Organisationen sein - z.B. eine Teilzeitkraft, die in zwei Cafés angestellt ist.</li>
  <li>Eine Organisation ist Clair-Teilnehmer, weil sie vernetzte CO<sub>2</sub>-Sensoren betreibt. Diese Sensoren sind als <em>Nodes</em> in der Clair Plattform abgebildet und fest der jeweiligen Organisation zugeordnet.</li>
  <li>Jede Organisation hat mindestens einen durch eine <em>Adresse</em> identifizierten <em>Ort</em> (Site). Dort befindet sich beispielsweise ein Geschäft, Restaurant oder eine Praxis. Eine Organisation kann auch mehrere Orte betreiben, wie z.B. bei einer Café-Kette.</li>
  <li>Jeder Ort kann über einen oder mehrere <em>Räume</em> verfügen, in denen wiederum ein oder mehrere Sensoren installert sein können.</li>
  <li>Eine <em>Installation</em> kann von begrenzter Dauer sein. Somit ist es möglich, einen Sensor nach einer bestimmten Zeit aus einem Raum in einen anderen umzuhängen.</li>
</ul>

<p>Dieses Datenmodell ist in der folgenden Abbildung in vereinfachter
Weise als Entity-Relationship-Diagramm dargestellt.</p>

<p><img src="/img/clair-er-diagram.png" alt="Clair Berlin Entity-Relationship-Diagramm" /></p>

<h3 id="client-anwendungen">Client-Anwendungen</h3>

<p>Der Zugriff auf die Clair Plattform erfolgt grundsätzlich über die REST-Schnittstelle des Clair Servers. Je nach Nutzer sehen wir verschiedene Client-Anwendungen vor:</p>

<ul>
  <li>Das <em>Clair Widget</em> richtet sich an die Öffentlichkeit; es visualisert den Verlauf der  CO<sub>2</sub>-Konzentration an einem bestimmten Ort - sofern die Organisation ihre Installationen am jeweiligen Ort als <em>öffentlich</em> freigegeben hat. Das Widget ist eine kleine JavaScript-Anwendung, die in Websites oder Smartphone-Apps eingebunden werden kann.</li>
  <li>Das <em>Betreiber-Dashboard</em> dient den Mitgliedern einer Organisation zur Verwaltung ihrer Sensoren, Orte, Räume und Installationen. Über das Dashboard können Betreiber alle Messwerte aller Sensoren einsehen und entscheiden, welche davon sie veröffentlichen möchten. Nur die Messwerte der als <em>öffentlich</em> gekennzeichneten Installationen stehen nicht-angemeldeten Benutzern zur Verfügung.</li>
  <li>Das <em>Admin-UI</em> dient der Wartung des Systems sowie der Pflege aller Daten im Testbetrieb. Nur Systemadministratoren haben Zugang.</li>
</ul>

<h2 id="quellcode">Quellcode</h2>

<p>Der gesamte Quellcode der Clair Plattform ist in einzelnen Repositorys der <a href="https://github.com/ClairBerlin">Clair Berlin
Organisation auf GitHub</a> verfügbar. Pull
Requests sind willkommen. Den Kern des Systems bilden die folgenden Repositories:</p>

<ul>
  <li><a href="https://github.com/ClairBerlin/clair-stack">clair-stack</a>: Die Definition des
<a href="https://docs.docker.com/get-started/swarm-deploy/">Docker-Service-Stacks</a>
der Gesamtinfrastruktur</li>
  <li><a href="https://github.com/ClairBerlin/managair">managair</a>, der zentrale Server: Eine
<a href="https://www.djangoproject.com/">Django</a>-Anwendung, die das Datenmodell und
die REST-Schnittstelle implementiert.</li>
  <li><a href="https://github.com/ClairBerlin/clair-ttn">clair-ttn</a>: Eine in Python
geschriebene TTN-Application, die zur Anbindung anderer LoRaWAN-Sensoren
erweitert werden kann.</li>
  <li><a href="https://github.com/ClairBerlin/clair-admin-ui">clair-admin-ui</a>: Das mit
Hilfe des <a href="https://quasar.dev/">Quasar-Frameworks</a> entwickelte Betreiber-Dashboard.</li>
</ul>

<h2 id="mitarbeit-und-nutzung-der-clair-plattform">Mitarbeit und Nutzung der Clair-Plattform</h2>

<p>Clair Berlin ist eine nichtkommerzielle Initiative; sämtliche oben beschriebenen <em>Assets</em> liegen im Quellcode vor und können durch Dritte genutzt werden. Wenn ihr mitarbeiten möchtet, so ist dies in allen Fachgebieten möglich: Entwicklung, Design, Kommunikation etc.</p>

<p>Die Clair REST-Schnittstelle ist komplett dokumentiert und folgt der <a href="https://jsonapi.org">JSON:API</a>-Spezifikation, so dass ihr auch einfach eigene Client-Anwendungen entwickeln könnt.</p>

<p>Wir denken die Clair Plattform <em>regional</em>, und betreiben derzeit die erste Instanz in Berlin. Wenn ihr in einer anderen Region ebenfalls ein Clair Netzwerk aufbauen möchtet, so setzt ihr dazu am besten jeweils eine neue Instanz der Clair Plattform auf. Dabei unterstützen wir euch gerne!</p>

</main>

    </div>

    <footer class="py-4 mt-auto text-light text-center bg-dark">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 col-sm-4 my-2">
        <nav class="nav flex-column">
          
            <a class="nav-link" href="/impressum.html">Impressum</a>
          
            <a class="nav-link" href="/datenschutz.html">Datenschutz</a>
          
        </nav>
      </div>
      <div class="col-12 col-sm-4 my-2">
        &copy; 2020 Clair Berlin
      </div>
      <div class="col-12 col-sm-4 my-2">
        
          <a class="mx-2" href="mailto:kontakt@clair-berlin.de"><i class="h2 fas fa-envelope"></i></a>
        
          <a class="mx-2" href="https://twitter.com/clair_berlin"><i class="h2 fab fa-twitter"></i></a>
        
          <a class="mx-2" href="https://www.facebook.com/ClairBerlinInitiative"><i class="h2 fab fa-facebook-square"></i></a>
        
          <a class="mx-2" href="/feed.xml"><i class="h2 fas fa-rss-square"></i></a>
        
          <a class="mx-2" href="https://github.com/ClairBerlin"><i class="h2 fab fa-github"></i></a>
        
      </div>
    </div>
  </div>
</footer>

    <script src="/js/jquery-3.5.1.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script>
      function openAnchorAccordion() {
        if (window.location.hash) {
          const hash = window.location.hash
          var target = jQuery('body').find(window.location.hash);
          if (target.hasClass('faq')) {
            var collapsable = target.find('.collapse');
            collapsable.collapse('show');
            collapsable.on('shown.bs.collapse', function (e) {
              location.hash = hash
            })
          }
        }
      }

      openAnchorAccordion();

      $("a[href*='#']").click(function(e) {
        window.location = e.currentTarget.href
        openAnchorAccordion();
      });
    </script>
  </body>
</html>
