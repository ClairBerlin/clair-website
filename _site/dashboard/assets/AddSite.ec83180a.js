import{u as v,aj as h,R as b,C as f,c as i,o as y,f as g,b as x,g as I,d as S}from"./vendor.4e13af1e.js";import{_ as O}from"./SiteForm.e4ebf766.js";import"./TextInput.04a3bb8c.js";import"./camelCase.9a2aa24e.js";import"./SubmitButton.13bbed99.js";const A={class:"max-w-sm sm:max-w-lg mt-8"},B={class:"bg-white rounded-md shadow-md p-6"},V={setup(E){const n=v(),c=h(),u=b(),{t:d}=f(),p=i(()=>n.state.nav.currentOrgId),m=i(()=>n.getters["nav/isOwner"]),l=async({name:e,description:t,street1:a,street2:r,zip:s,city:o})=>{const j=await w({street1:a,street2:r,zip:s,city:o});_({name:e,description:t,addressId:j})},_=async({name:e,description:t,addressId:a})=>{let r={_jv:{type:"Site",relationships:{operator:{data:{type:"Organization",id:p.value}},address:{data:{type:"Address",id:a}}}},name:e,description:t};try{const{_jv:s}=await n.dispatch("jv/post",[r,{url:"sites/"}]);u.push({name:"sites",params:{siteId:s.id}})}catch{c.error(d("site.createError"))}},w=async({street1:e,street2:t,zip:a,city:r})=>{let s={_jv:{type:"Address"},street1:e,street2:t,zip:a,city:r};try{const{_jv:o}=await n.dispatch("jv/post",[s,{url:"/addresses/"}]);return o.id}catch(o){c.error(d("address.createError")),console.log(o)}};return(e,t)=>(y(),g("div",A,[x("div",B,[I(O,{"allow-edit":S(m),"button-text":"site.add","on-submit":l},null,8,["allow-edit"])])]))}};export{V as default};
