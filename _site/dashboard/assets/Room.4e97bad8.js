import{Q as D,q,aj as E,C as F,s as m,E as g,r as M,u as o,o as n,e as L,c as d,a as t,t as s,am as y,an as f,b as u,g as j,w as I,F as A,l as H,n as P,d as O,a7 as Q,O as G}from"./vendor.ef2875e8.js";import{d as N,i as J}from"./index.1e325c4d.js";import{L as K}from"./index.d8cdb002.js";const W={key:1},X={class:"max-w-sm sm:max-w-lg"},Y={class:"text-black mt-2 p-4 card rounded-md shadow-md ring-1 ring-gray-300 bg-white"},Z={class:"form-control"},tt={class:"label"},et={class:"label-text text-black font-bold"},st=["placeholder"],ot={class:"form-control py-4"},at={class:"label"},lt={class:"label-text text-black font-bold"},nt=["placeholder"],it={class:"form-control"},dt={class:"label"},rt={class:"label-text text-black font-bold"},ct=t("sup",null,"2",-1),mt=u("] "),ut=["placeholder"],pt={class:"form-control"},_t={class:"label"},ht={class:"label-text text-black font-bold"},xt=["placeholder"],vt={class:"form-control"},bt={class:"label"},gt={class:"label-text text-black font-bold"},yt=["placeholder"],ft={key:0,class:"ring-1 ring-gray-300 rounded-md bg-white text-md overflow-hidden mt-8"},wt={class:"flex justify-end items-center"},kt={class:"flex flex-row"},$t={class:"min-w-full divide-y divide-gray-200"},jt={class:"bg-gray-50"},It={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},Ot={scope:"col",class:"sm:px-6 py-3 text-right text-xs font-medium text-gray-500 tracking-wider"},Ct={scope:"col",class:"sm:px-6 py-3 text-right text-xs font-medium text-gray-500 tracking-wider"},Rt={scope:"col",class:"sm:px-6 py-3 text-right text-xs font-medium text-gray-500 tracking-wider hidden md:table-cell"},Vt={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},Lt={class:"px-2 sm:px-6 py-4 whitespace-nowrap"},Nt={class:"px-2 sm:px-6 py-4 whitespace-nowrap text-right"},Tt={class:"px-2 sm:px-6 py-4 whitespace-nowrap text-right"},zt={class:"px-2 sm:px-6 py-4 whitespace-nowrap text-right"},St={class:"px-2 sm:px-6 py-4 whitespace-nowrap"},Ut={class:"flex flex-col sm:flex-row"},Bt={class:"flex flex-row"},Dt=["onClick"],qt={key:1,class:"shadow-md mt-4 rounded-md max-w-sm flex items-center bg-yellow-50 border-l-4 border-yellow-400 p-4"},Et={class:"flex"},Ft={class:"flex-shrink-0"},Mt={class:"ml-3"},Jt={setup(At){const T=D(),r=q(),w=E(),{t:k,n:C}=F(),R=m(()=>r.getters["nav/isOrgContextLoading"]),c=m(()=>T.params.roomId),p=m(()=>r.getters["jv/get"]({_jv:{type:"Room",id:c.value}})),$=m(()=>r.getters["nav/isOwner"]),V=m(()=>{const e=r.getters["jv/get"]("Installation",`$[?(@.room._jv.id=="${c.value}")]`);return Object.entries(e).map(([,i])=>i)}),z=m(()=>{var e;return!R.value&&((e=V.value)==null?void 0:e.length)>0}),_=g(void 0),h=g(void 0),x=g(void 0),v=g(void 0),b=g(void 0),S=async()=>{if(_.value||h.value||x.value||v.value||b.value){let e={_jv:{type:"Room",id:c.value}};_.value&&(e.name=_.value),h.value&&(e.description=h.value),x.value&&(e.size_sqm=x.value.replace(",",".")),v.value&&(e.height_m=v.value.replace(",",".")),b.value&&(e.max_occupancy=b.value);try{await r.dispatch("jv/patch",[e,{url:`rooms/${c.value}/`}]),w.success(k("room.updateSuccess"))}catch(l){w.error(k("room.updateError")),console.log(l)}}},U=async e=>{const l={_jv:{type:"Installation",id:e},to_timestamp_s:G().unix()};try{await r.dispatch("jv/patch",[l,{url:`installations/${e}/`}]),w.success(k("installation.successTerminate"))}catch(i){w.error(k("installation.errorTerminate")),console.log(i)}};return(e,l)=>{const i=M("router-link");return o(R)?(n(),L(K,{key:0})):(n(),d("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("label",tt,[t("span",et,s(e.$t("room.name")),1)]),y(t("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>_.value=a),placeholder:o(p).name,class:"input-bordered como-focus rounded bg-white text-gray-600"},null,8,st),[[f,_.value,void 0,{trim:!0}]])]),t("div",ot,[t("label",at,[t("span",lt,s(e.$t("description")),1)]),y(t("textarea",{type:"text","onUpdate:modelValue":l[1]||(l[1]=a=>h.value=a),placeholder:o(p).description,class:"como-focus rounded h-24 text-gray-600"},null,8,nt),[[f,h.value,void 0,{trim:!0}]])]),t("div",it,[t("label",dt,[t("span",rt,[u(s(e.$t("room.size"))+" [m",1),ct,mt])]),y(t("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=a=>x.value=a),placeholder:o(C)(Number(o(p).size_sqm)),class:"input-bordered como-focus rounded bg-white text-gray-600"},null,8,ut),[[f,x.value,void 0,{trim:!0}]])]),t("div",pt,[t("label",_t,[t("span",ht,s(e.$t("room.height"))+" [m] ",1)]),y(t("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=a=>v.value=a),placeholder:o(C)(Number(o(p).height_m)),class:"input-bordered como-focus rounded bg-white text-gray-600"},null,8,xt),[[f,v.value,void 0,{trim:!0}]])]),t("div",vt,[t("label",bt,[t("span",gt,s(e.$t("room.maxOccupancy")),1)]),y(t("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=a=>b.value=a),placeholder:o(p).max_occupancy,class:"input-bordered como-focus rounded bg-white text-gray-600"},null,8,yt),[[f,b.value,void 0,{trim:!0}]])]),o($)?(n(),d("button",{key:0,class:"mt-2 btn gray-button font-semibold",onClick:S},s(e.$t("update")),1)):j("",!0)])]),o(z)?(n(),d("div",ft,[t("div",wt,[t("div",kt,[o($)?(n(),L(i,{key:0,class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",to:{name:"addInstallation",params:{roomId:o(c)}}},{default:I(()=>[u(s(e.$t("installation.add")),1)]),_:1},8,["to"])):j("",!0)])]),t("table",$t,[t("thead",jt,[t("tr",null,[t("th",It,s(e.$t("room.sensor")),1),t("th",Ot,s(e.$t("installation.isPublic")),1),t("th",Ct,s(e.$t("installation.installedOn")),1),t("th",Rt,s(e.$t("installation.removedOn")),1),t("th",Vt,s(e.$t("actions")),1)])]),t("tbody",null,[(n(!0),d(A,null,H(o(V),(a,B)=>(n(),d("tr",{key:a._jv.id,class:P([B%2==0?"bg-white":"bg-gray-50"])},[t("td",Lt,s(a.node.alias),1),t("td",Nt,s(a.is_public),1),t("td",Tt,s(o(N)(a.from_timestamp_s)),1),t("td",zt,s(o(N)(a.to_timestamp_s)),1),t("td",St,[t("div",Ut,[t("div",Bt,[O(i,{class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",to:{name:"installation",params:{installationId:a._jv.id}}},{default:I(()=>[u(s(e.$t("inspect")),1)]),_:2},1032,["to"])]),o($)&&o(J)(a)?(n(),d("div",{key:0,class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",onClick:Ht=>U(a._jv.id)},s(e.$t("installation.terminate")),9,Dt)):j("",!0)])])],2))),128))])])])):(n(),d("div",qt,[t("div",Et,[t("div",Ft,[O(o(Q),{class:"h-5 w-5 text-yellow-400","aria-hidden":"true"})]),t("div",Mt,[u(s(e.$t("room.noInstallations"))+". "+s(" "),1),O(i,{to:{name:"addInstallation",params:{roomId:o(c)}},class:"font-medium underline text-yellow-700 hover:text-yellow-600"},{default:I(()=>[u(s(e.$t("room.addInstallation")),1)]),_:1},8,["to"])])])]))]))}}};export{Jt as default};
