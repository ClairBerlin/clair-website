var L=Object.defineProperty,q=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var j=(l,o,a)=>o in l?L(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a,M=(l,o)=>{for(var a in o||(o={}))G.call(o,a)&&j(l,a,o[a]);if(O)for(var a of O(o))P.call(o,a)&&j(l,a,o[a]);return l},C=(l,o)=>q(l,E(o));import{s as U,R as A,q as H,G as h,v as b,S as J,U as K,o as r,c as i,a as e,t,u as v,g as u,d as x,w as Q,ag as D,ah as W,F as z,l as X,n as Y}from"./vendor.eafa4657.js";import{r as Z}from"./index.8fc35793.js";import{_ as ee}from"./DeletionModal.c7a6faaa.js";const se={key:0,class:"bg-white shadow-md sm:rounded-md"},te={class:"max-w-screen-xl px-4 py-6 mx-auto sm:px-6 lg:px-8"},oe={class:"text-3xl font-bold leading-tight text-gray-900"},ae={key:1},ne={key:2,class:"mt-8"},le={class:"text-sm text-gray-500"},re={class:"text-black"},ie={class:"flex justify-end items-center"},de={class:"flex"},ce={class:"ring-1 ring-gray-300 rounded-md bg-white text-md overflow-hidden"},me={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-gray-50"},pe={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},ge={scope:"col",class:"sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},he={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider hidden md:table-cell"},ve={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},xe={class:"px-2 sm:px-6 py-4 whitespace-nowrap"},_e={class:"flex"},ye={class:"text-gray-700 text-sm"},fe={class:"sm:px-6 py-4 whitespace-nowrap"},we={class:"hidden md:table-cell px-2 sm:px-6 py-4 whitespace-nowrap"},be={class:"px-2 sm:px-6 py-4 whitespace-nowrap"},$e={class:"flex flex-col sm:flex-row"},Ce={setup(l){const o=U(),a=A(),d=H(),_=h([]),p=h(),R=b(()=>{var s;return((s=p==null?void 0:p.value)==null?void 0:s.name)||"\u2026"}),m=b(()=>o.params.orgId);J(async()=>$()),K(m,()=>$());const y=h(!0),B=b(()=>d.getters["authuser/getMembershipByOrgId"](o.params.id)),g=()=>{var s;return((s=B.value)==null?void 0:s.role)==="O"},f=h(!1),I=()=>f.value=!0,N=async()=>{await d.dispatch("jv/delete",`organizations/${m.value}`),a.push({name:"org-management"})},S=()=>console.log("TODO: open invite modal"),T=()=>console.log("TODO: open modal to confirm removal"),V=()=>console.log("TODO: open modal to change role"),F=(s,c)=>Z(Object.values(s).find(n=>n.user_name===c).role),$=async()=>{_.value=[],y.value=!0,p.value=await d.dispatch("jv/get",`organizations/${m.value}`);const s=await d.dispatch("jv/get",`organizations/${m.value}/users`),c=await d.dispatch("jv/get",`organizations/${m.value}/memberships`),n=Object.keys(s).map(async w=>{const k=await d.dispatch("jv/get",`users/${w}`);_.value.push(C(M({},k),{role:F(c,k.username)}))});await Promise.all(n),y.value=!1};return(s,c)=>(r(),i(z,null,[s.$route.meta.title?(r(),i("header",se,[e("div",te,[e("h1",oe,t(s.$t("org.members"))+" "+t(s.$t("of"))+" "+t(v(R)),1)])])):u("",!0),y.value?(r(),i("div",ae,t(s.$t("loading...")),1)):(r(),i("div",ne,[x(ee,{open:f.value,onCloseModal:c[0]||(c[0]=n=>f.value=!1),onDeleteClicked:N,"modal-title":"delete-org-modal.title"},{default:Q(()=>[e("p",le,t(s.$t("delete-org-modal.message")),1)]),_:1},8,["open"]),e("div",re,[e("div",ie,[e("div",de,[g?(r(),i("div",{key:0,class:"m-2 gray-button font-semibold",onClick:I},[x(v(D),{class:"w-4 h-4 mr-2"}),e("span",null,t(s.$t("org.delete")),1)])):u("",!0),g?(r(),i("div",{key:1,class:"m-2 mr-0 gray-button font-semibold",onClick:S},[x(v(W),{class:"w-4 h-4 mr-2"}),e("span",null,t(s.$t("org.invite")),1)])):u("",!0)])]),e("div",ce,[e("table",me,[e("thead",ue,[e("tr",null,[e("th",pe,t(s.$t("name")),1),e("th",ge,t(s.$t("email")),1),e("th",he,t(s.$t("role.singular")),1),e("th",ve,t(s.$t("actions")),1)])]),e("tbody",null,[(r(!0),i(z,null,X(_.value,(n,w)=>(r(),i("tr",{key:n.id,class:Y([w%2==0?"bg-white":"bg-gray-50"])},[e("td",xe,[e("div",_e,t(n.first_name)+" "+t(n.last_name),1),e("div",ye,t(n.username),1)]),e("td",fe,t(n.email),1),e("td",we,t(s.$t(n.role)),1),e("td",be,[e("div",$e,[g?(r(),i("div",{key:0,class:"btn-sm m-2 gray-button font-semibold w-max",onClick:V},t(s.$t("role.change")),1)):u("",!0),g?(r(),i("div",{key:1,class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",onClick:T},[x(v(D),{class:"w-4 h-4 mr-2"}),e("span",null,t(s.$t("remove")),1)])):u("",!0)])])],2))),128))])])])])]))],64))}};export{Ce as default};
