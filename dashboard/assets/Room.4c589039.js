import{Q as B,u as R,aj as S,C as F,c as m,r as V,d as s,o as r,a as k,f as p,b as t,g as x,w,e as y,t as o,i as $,F as q,p as E,n as z,a7 as A,O as D}from"./vendor.2e3a8e12.js";import{d as I,i as P}from"./index.6ae68e35.js";import{L as Q}from"./index.09f868a8.js";import{_ as G}from"./RoomForm.31b22ca4.js";import"./TextInput.c2c3ea64.js";import"./camelCase.8465eaba.js";import"./SubmitButton.7152d9eb.js";const H={key:1},J={class:"max-w-sm sm:max-w-lg mt-8"},K={class:"bg-white rounded-md shadow-md p-6"},M={key:0,class:"ring-1 ring-gray-300 rounded-md bg-white text-md overflow-hidden mt-8"},U={class:"flex justify-end items-center"},W={class:"flex flex-row"},X={class:"min-w-full divide-y divide-gray-200"},Y={class:"bg-gray-50"},Z={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},tt={scope:"col",class:"sm:px-6 py-3 text-right text-xs font-medium text-gray-500 tracking-wider"},et={scope:"col",class:"sm:px-6 py-3 text-right text-xs font-medium text-gray-500 tracking-wider"},st={scope:"col",class:"sm:px-6 py-3 text-right text-xs font-medium text-gray-500 tracking-wider hidden md:table-cell"},ot={scope:"col",class:"px-2 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 tracking-wider"},at={class:"px-2 sm:px-6 py-4 whitespace-nowrap"},nt={class:"px-2 sm:px-6 py-4 whitespace-nowrap text-right"},it={class:"px-2 sm:px-6 py-4 whitespace-nowrap text-right"},rt={class:"px-2 sm:px-6 py-4 whitespace-nowrap text-right"},lt={class:"px-2 sm:px-6 py-4 whitespace-nowrap"},ct={class:"flex flex-col sm:flex-row"},dt={class:"flex flex-row"},mt=["onClick"],pt={key:1,class:"shadow-md mt-4 rounded-md max-w-sm flex items-center bg-yellow-50 border-l-4 border-yellow-400 p-4"},ut={class:"flex"},_t={class:"flex-shrink-0"},ht={class:"ml-3"},kt={setup(xt){const C=B(),l=R(),u=S(),{t:_,n:g}=F(),f=m(()=>l.getters["nav/isOrgContextLoading"]),c=m(()=>C.params.roomId),i=m(()=>l.getters["jv/get"]({_jv:{type:"Room",id:c.value}})),v=m(()=>l.getters["nav/isOwner"]),b=m(()=>{const e=l.getters["jv/get"]("Installation",`$[?(@.room._jv.id=="${c.value}")]`);return Object.entries(e).map(([,n])=>n)}),O=m(()=>{var e;return!f.value&&((e=b.value)==null?void 0:e.length)>0}),L=async({name:e,description:d,size:n,height:a,capacity:h})=>{if(i.value.name===e&&i.value.description===d&&i.value.size_sqm===n&&i.value.height_m===a&&i.value.max_occupancy===h)return;const j={_jv:{type:"Room",id:c.value},name:e,description:d,size_sqm:(n==null?void 0:n.replace(",","."))||void 0,height_m:(a==null?void 0:a.replace(",","."))||void 0,max_occupancy:h||void 0};try{await l.dispatch("jv/patch",[j,{url:`rooms/${c.value}/`}]),u.success(_("room.updateSuccess"))}catch(T){u.error(_("room.updateError")),console.log(T)}},N=async e=>{const d={_jv:{type:"Installation",id:e},to_timestamp_s:D().unix()};try{await l.dispatch("jv/patch",[d,{url:`installations/${e}/`}]),u.success(_("installation.successTerminate"))}catch(n){u.error(_("installation.errorTerminate")),console.log(n)}};return(e,d)=>{const n=V("router-link");return s(f)?(r(),k(Q,{key:0})):(r(),p("div",H,[t("div",J,[t("div",K,[x(G,{"allow-edit":s(v),"room-name":s(i).name,"room-description":s(i).description,"room-size":s(g)(Number(s(i).size_sqm)),"room-height":s(g)(Number(s(i).height_m)),"room-capacity":s(g)(Number(s(i).max_occupancy)),"button-text":"update","on-submit":L},null,8,["allow-edit","room-name","room-description","room-size","room-height","room-capacity"])])]),s(O)?(r(),p("div",M,[t("div",U,[t("div",W,[s(v)?(r(),k(n,{key:0,class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",to:{name:"addInstallation",params:{roomId:s(c)}}},{default:w(()=>[y(o(e.$t("installation.add")),1)]),_:1},8,["to"])):$("",!0)])]),t("table",X,[t("thead",Y,[t("tr",null,[t("th",Z,o(e.$t("room.sensor")),1),t("th",tt,o(e.$t("installation.isPublic")),1),t("th",et,o(e.$t("installation.installedOn")),1),t("th",st,o(e.$t("installation.removedOn")),1),t("th",ot,o(e.$t("actions")),1)])]),t("tbody",null,[(r(!0),p(q,null,E(s(b),(a,h)=>(r(),p("tr",{key:a._jv.id,class:z([h%2==0?"bg-white":"bg-gray-50"])},[t("td",at,o(a.node.alias),1),t("td",nt,o(e.$t(`installation.public.${a.is_public}`)),1),t("td",it,o(s(I)(a.from_timestamp_s)),1),t("td",rt,o(s(I)(a.to_timestamp_s)),1),t("td",lt,[t("div",ct,[t("div",dt,[x(n,{class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",to:{name:"installation",params:{installationId:a._jv.id}}},{default:w(()=>[y(o(e.$t("inspect")),1)]),_:2},1032,["to"])]),s(v)&&s(P)(a)?(r(),p("div",{key:0,class:"btn-sm m-2 mr-0 gray-button font-semibold w-max",onClick:j=>N(a._jv.id)},o(e.$t("installation.terminate")),9,mt)):$("",!0)])])],2))),128))])])])):(r(),p("div",pt,[t("div",ut,[t("div",_t,[x(s(A),{class:"h-5 w-5 text-yellow-400","aria-hidden":"true"})]),t("div",ht,[y(o(e.$t("room.noInstallations"))+". "+o(" "),1),x(n,{to:{name:"addInstallation",params:{roomId:s(c)}},class:"font-medium underline text-yellow-700 hover:text-yellow-600"},{default:w(()=>[y(o(e.$t("room.addInstallation")),1)]),_:1},8,["to"])])])]))]))}}};export{kt as default};
